(function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a=typeof require=="function"&&require;if(!u&&a)return a(o,!0);if(i)return i(o,!0);var f=new Error("Cannot find module '"+o+"'");throw f.code="MODULE_NOT_FOUND",f}var l=n[o]={exports:{}};t[o][0].call(l.exports,function(e){var n=t[o][1][e];return s(n?n:e)},l,l.exports,e,t,n,r)}return n[o].exports}var i=typeof require=="function"&&require;for(var o=0;o<r.length;o++)s(r[o]);return s})({1:[function(require,module,exports){
"use strict";!function(){var e=void 0,t=function(e){var t=n(e);return t&&t.params?t.params.id:""},n=function(e){var t=document.createElement("a");return t.href=e,{source:e,protocol:t.protocol.replace(":",""),host:t.hostname,port:t.port,query:t.search,params:function(){for(var e,n={},o=t.search.replace(/^\?/,"").split("&"),a=o.length,r=0;a>r;r++)o[r]&&(e=o[r].split("="),n[e[0]]=e[1]);return n}(),file:(t.pathname.match(/\/([^\/?#]+)$/i)||[,""])[1],hash:t.hash.replace("#",""),path:t.pathname.replace(/^([^\/])/,"/$1"),relative:(t.href.match(/tp:\/\/[^\/]+(.+)/)||[,""])[1],segments:t.pathname.replace(/^\//,"").split("/")}},o=function(e){return $.simplyToast(e,"danger")},a=function(e){return $.simplyToast(e,"success")},r=n(window.location.url),c=!1,i=$("#tpls"),s=$("#sources"),l=$("#btn-regen"),u=$("#runner-output"),d=$("#generator-featured, #generator-list"),f=$("#generator"),m=$("#generator-name"),p=$("#generator-title"),v=$("#generator-desc"),h=void 0,g=new Generador({host:"//"+r.host+(r.port?":"+r.port:"")}),b=function(e){return e.match(/;@tpl\|/m)?e:";@tpl|main\n"+e},k=function(){var e=b(i.val());h=g.parseString(""+e+s.val()).then(function(){c=!0,w()})},w=function(){c&&u.empty().append(g.toHtml(g.generate()))},C=function(e){var t=void 0;e?(a("Guardado con exito"),t=e.link+"?edit=1"):(a("Contenido eliminado con exito"),t="/generadores/"),setTimeout(function(){window.location.href=t},500)},E=function(e){var t="NEW"===e?"":e,n=m.val().trim(),r=v.val().trim();if(!n||!r)return void o("Falta nombre o descripcion");var c={name:n,desc:r,data:{tpls:b(i.val()),tables:s.val()}};return t?g.remotes.update(t,c).then(function(e){a("Guardado con exito")})["catch"](function(e){o(e.message)}):void g.remotes.create(c).then(C)["catch"](function(e){o(e.message)})},y=function(e){var t=m.val().trim()+" - copia",n=v.val().trim();return t&&n?void g.remotes.create({name:t,desc:n,parent:e,data:{tpls:b(i.val()),tables:s.val()}}).then(C)["catch"](function(e){o(e.message)}):void o("Falta nombre o descripcion")},N=function(e){var t=confirm("Quieres borrar este generador? Esta accion no se puede deshacer.");t&&g.remotes.remove(e).then(function(){return C()})["catch"](function(e){o(e.message)})},T=function(t){return t&&"NEW"!==e?($("#fork").removeClass("disabled").off("click").on("click",function(){return y(e)}),void(t.owned&&$("#remove").removeClass("disabled").off("click").on("click",function(){return N(e)}))):void $("#save").removeClass("disabled").off("click").on("click",function(){return E(e)})},G=function(e){p.html($(e.target).val())},x=function(e){return f.removeClass("hide"),i.on("change",k),m.on("change",G),s.on("change",k),l.on("click",w),"NEW"===e?void k():void g.remotes.load(e).then(function(t){return t||Promise.reject("No hay datos para el identificador "+e)}).then(function(e){m.val(e.name),v.val(e.desc),i.val(b(e.data.tpls)),s.val(e.data.tables),T(e),k(),w()})["catch"](function(t){o("No hay datos para el identificador "+e)})};$(function(){if(e=GENERATOR_SOURCE_ID||t(window.location.href),!e)return void d.removeClass("hide");x(e);var n=new Clipboard("#btn-copy");n.on("success",function(e){a("Copiado al portapapeles"),e.clearSelection()}),g.getTokenFromAuth().then(function(e){T()})["catch"](function(e){})})}();

},{}]},{},[1])
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIm5vZGVfbW9kdWxlcy9icm93c2VyLXBhY2svX3ByZWx1ZGUuanMiLCJEOlxcd29ya3NwYWNlXFxjb21wYXJ0aWRvXFxIRVJPS1VcXHJvbGVhbmRvXFxzdGF0aWNcXGpzXFxnZW5lcmFkb3Jlcy5qcyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFBQTtBQ0FBLGNBQ0UsV0FFQSxHQUFJLEdBQUEsT0FDRSxFQUFtQixTQUFBLEdBQ3ZCLEdBQU0sR0FBTSxFQUFTLEVBQ3JCLE9BQVEsSUFBTyxFQUFJLE9BQVUsRUFBSSxPQUFPLEdBQUssSUFHekMsRUFBVyxTQUFBLEdBQ2YsR0FBSSxHQUFJLFNBQVMsY0FBYyxJQUUvQixPQURBLEdBQUUsS0FBTyxHQUVQLE9BQVEsRUFDUixTQUFVLEVBQUUsU0FBUyxRQUFRLElBQUssSUFDbEMsS0FBTSxFQUFFLFNBQ1IsS0FBTSxFQUFFLEtBQ1IsTUFBTyxFQUFFLE9BQ1QsT0FBUyxXQUlQLElBSEEsR0FFMkIsR0FGdkIsS0FDRixFQUFNLEVBQUUsT0FBTyxRQUFRLE1BQU0sSUFBSSxNQUFNLEtBQ3ZDLEVBQU0sRUFBSSxPQUFRLEVBQUksRUFDaEIsRUFBRixFQUFNLElBQ0wsRUFBSSxLQUNULEVBQUksRUFBSSxHQUFHLE1BQU0sS0FDakIsRUFBSSxFQUFFLElBQU0sRUFBRSxHQUVoQixPQUFPLE1BRVQsTUFBTyxFQUFFLFNBQVMsTUFBTSxvQkFBcUIsQ0FBRyxLQUFLLEdBQ3JELEtBQU0sRUFBRSxLQUFLLFFBQVEsSUFBSyxJQUMxQixLQUFNLEVBQUUsU0FBUyxRQUFRLFdBQVksT0FDckMsVUFBVyxFQUFFLEtBQUssTUFBTSx1QkFBd0IsQ0FBRyxLQUFLLEdBQ3hELFNBQVUsRUFBRSxTQUFTLFFBQVEsTUFBTyxJQUFJLE1BQU0sT0FJNUMsRUFBWSxTQUFBLEdBQUEsTUFBTyxHQUFFLFlBQVksRUFBSyxXQUN0QyxFQUFVLFNBQUEsR0FBQSxNQUFPLEdBQUUsWUFBWSxFQUFLLFlBRXBDLEVBQU8sRUFBUyxPQUFPLFNBQVMs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SSxFQUFRLEVBQUksS0FBSyxPQUMzQixFQUFTLElBQUksRUFBSSxLQUFLLFFBQ3RCLEVBQWUsR0FDZixJQUNBLE1BVkosU0FZUyxTQUFBLEdBQ0wsRUFBQSxzQ0FBZ0QsS0FLdEQsR0FBRSxXQUtBLEdBRkEsRUFBWSxxQkFBdUIsRUFBaUIsT0FBTyxTQUFTLE9BRS9ELEVBRUgsV0FEQSxHQUFVLFlBQVksT0FJeEIsR0FBYyxFQUVkLElBQU0sR0FBWSxHQUFJLFdBQVUsWUFDaEMsR0FBVSxHQUFHLFVBQVcsU0FBQSxHQUN0QixFQUFRLDJCQUNSLEVBQUUsbUJBSUosRUFBSSxtQkFDRCxLQUFLLFNBQUEsR0FDSixNQUZKLFNBSVMsU0FBQSIsImZpbGUiOiJnZW5lcmF0ZWQuanMiLCJzb3VyY2VSb290IjoiIiwic291cmNlc0NvbnRlbnQiOlsiKGZ1bmN0aW9uIGUodCxuLHIpe2Z1bmN0aW9uIHMobyx1KXtpZighbltvXSl7aWYoIXRbb10pe3ZhciBhPXR5cGVvZiByZXF1aXJlPT1cImZ1bmN0aW9uXCImJnJlcXVpcmU7aWYoIXUmJmEpcmV0dXJuIGEobywhMCk7aWYoaSlyZXR1cm4gaShvLCEwKTt2YXIgZj1uZXcgRXJyb3IoXCJDYW5ub3QgZmluZCBtb2R1bGUgJ1wiK28rXCInXCIpO3Rocm93IGYuY29kZT1cIk1PRFVMRV9OT1RfRk9VTkRcIixmfXZhciBsPW5bb109e2V4cG9ydHM6e319O3Rbb11bMF0uY2FsbChsLmV4cG9ydHMsZnVuY3Rpb24oZSl7dmFyIG49dFtvXVsxXVtlXTtyZXR1cm4gcyhuP246ZSl9LGwsbC5leHBvcnRzLGUsdCxuLHIpfXJldHVybiBuW29dLmV4cG9ydHN9dmFyIGk9dHlwZW9mIHJlcXVpcmU9PVwiZnVuY3Rpb25cIiYmcmVxdWlyZTtmb3IodmFyIG89MDtvPHIubGVuZ3RoO28rKylzKHJbb10pO3JldHVybiBzfSkiLCIndXNlIHN0cmljdCdcclxuOyhmdW5jdGlvbiAoKSB7XHJcblxyXG4gIGxldCBTT1VSQ0VfSURcclxuICBjb25zdCBnZXRSZW1vdGVGcm9tVXJsID0gcmF3VXJsID0+IHtcclxuICAgIGNvbnN0IHVybCA9IHBhcnNlVVJMKHJhd1VybClcclxuICAgIHJldHVybiAodXJsICYmIHVybC5wYXJhbXMpID8gdXJsLnBhcmFtcy5pZCA6ICcnXHJcbiAgfVxyXG5cclxuICBjb25zdCBwYXJzZVVSTCA9IHVybCA9PiB7XHJcbiAgICB2YXIgYSA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2EnKVxyXG4gICAgYS5ocmVmID0gdXJsXHJcbiAgICByZXR1cm4ge1xyXG4gICAgICBzb3VyY2U6IHVybCxcclxuICAgICAgcHJvdG9jb2w6IGEucHJvdG9jb2wucmVwbGFjZSgnOicsICcnKSxcclxuICAgICAgaG9zdDogYS5ob3N0bmFtZSxcclxuICAgICAgcG9ydDogYS5wb3J0LFxyXG4gICAgICBxdWVyeTogYS5zZWFyY2gsXHJcbiAgICAgIHBhcmFtczogKGZ1bmN0aW9uICgpIHtcclxuICAgICAgICB2YXIgcmV0ID0ge30sXHJcbiAgICAgICAgICBzZWcgPSBhLnNlYXJjaC5yZXBsYWNlKC9eXFw/LywnJykuc3BsaXQoJyYnKSxcclxuICAgICAgICAgIGxlbiA9IHNlZy5sZW5ndGgsIGkgPSAwLCBzO1xyXG4gICAgICAgIGZvciAoO2k8bGVuO2krKykge1xyXG4gICAgICAgICAgaWYgKCFzZWdbaV0pIHsgY29udGludWU7IH1cclxuICAgICAgICAgIHMgPSBzZWdbaV0uc3BsaXQoJz0nKTtcclxuICAgICAgICAgIHJldFtzWzBdXSA9IHNbMV07XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHJldHVybiByZXRcclxuICAgICAgfSkoKSxcclxuICAgICAgZmlsZTogKGEucGF0aG5hbWUubWF0Y2goL1xcLyhbXlxcLz8jXSspJC9pKSB8fCBbLCAnJ10pWzFdLFxyXG4gICAgICBoYXNoOiBhLmhhc2gucmVwbGFjZSgnIycsICcnKSxcclxuICAgICAgcGF0aDogYS5wYXRobmFtZS5yZXBsYWNlKC9eKFteXFwvXSkvLCAnLyQxJyksXHJcbiAgICAgIHJlbGF0aXZlOiAoYS5ocmVmLm1hdGNoKC90cDpcXC9cXC9bXlxcL10rKC4rKS8pIHx8IFssICcnXSlbMV0sXHJcbiAgICAgIHNlZ21lbnRzOiBhLnBhdGhuYW1lLnJlcGxhY2UoL15cXC8vLCAnJykuc3BsaXQoJy8nKVxyXG4gICAgfVxyXG4gIH1cclxuXHJcbiAgY29uc3Qgc2hvd0Vycm9yID0gZXJyID0+ICQuc2ltcGx5VG9hc3QoZXJyLCAnZGFuZ2VyJylcclxuICBjb25zdCBhbGVydE9rID0gbXNnID0+ICQuc2ltcGx5VG9hc3QobXNnLCAnc3VjY2VzcycpXHJcblxyXG4gIGNvbnN0IGJhc2UgPSBwYXJzZVVSTCh3aW5kb3cubG9jYXRpb24udXJsKVxyXG5cclxuICBsZXQgU1RBUlRFRCA9IGZhbHNlXHJcbiAgY29uc3QgJHRwbHMgPSAkKCcjdHBscycpXHJcbiAgY29uc3QgJHNvdXJjZXMgPSAkKCcjc291cmNlcycpXHJcbiAgY29uc3QgJGJ0blJlZ2VuID0gJCgnI2J0bi1yZWdlbicpXHJcbiAgY29uc3QgJG91dHB1dCA9ICQoJyNydW5uZXItb3V0cHV0JylcclxuICBjb25zdCAkZXhhbXBsZXMgPSAkKCcjZ2VuZXJhdG9yLWZlYXR1cmVkLCAjZ2VuZXJhdG9yLWxpc3QnKVxyXG4gIGNvbnN0ICRnZW5lcmF0b3IgPSAkKCcjZ2VuZXJhdG9yJylcclxuICBjb25zdCAkdGFibGVOYW1lID0gJCgnI2dlbmVyYXRvci1uYW1lJylcclxuICBjb25zdCAkdGFibGVUaXRsZSA9ICQoJyNnZW5lcmF0b3ItdGl0bGUnKVxyXG4gIGNvbnN0ICR0YWJsZURlc2MgPSAkKCcjZ2VuZXJhdG9yLWRlc2MnKVxyXG5cclxuICBsZXQgZ2VuZXJhZG9yXHJcblxyXG4gIGNvbnN0IGdlbiA9IG5ldyBHZW5lcmFkb3Ioe1xyXG4gICAgaG9zdDogYC8vJHtiYXNlLmhvc3R9JHtiYXNlLnBvcnQgPyAnOicrIGJhc2UucG9ydCA6ICcnfWBcclxuICB9KVxyXG5cclxuICBjb25zdCBnZXRUcGxzID0gc3JjID0+IHtcclxuICAgIGlmICghc3JjLm1hdGNoKC87QHRwbFxcfC9tKSkge1xyXG4gICAgICByZXR1cm4gYDtAdHBsfG1haW5cXG4ke3NyY31gXHJcbiAgICB9XHJcbiAgICByZXR1cm4gc3JjXHJcbiAgfVxyXG5cclxuICBjb25zdCByZXN0YXJ0R2VuZXJhdG9yID0gKCkgPT4ge1xyXG4gICAgY29uc3QgdHBscyA9IGdldFRwbHMoJHRwbHMudmFsKCkpXHJcbiAgICBnZW5lcmFkb3IgPSBnZW4ucGFyc2VTdHJpbmcoYCR7dHBsc30keyRzb3VyY2VzLnZhbCgpfWApLnRoZW4oKCkgPT4ge1xyXG4gICAgICBTVEFSVEVEID0gdHJ1ZVxyXG4gICAgICBydW5HZW5lcmF0b3IoKVxyXG4gICAgfSlcclxuICB9XHJcbiAgY29uc3QgcnVuR2VuZXJhdG9yID0gKCkgPT4ge1xyXG4gICAgaWYgKCFTVEFSVEVEKSByZXR1cm47XHJcblxyXG4gICAgJG91dHB1dC5lbXB0eSgpLmFwcGVuZChnZW4udG9IdG1sKGdlbi5nZW5lcmF0ZSgpKSlcclxuICB9XHJcblxyXG4gIGNvbnN0IHJlZGlyZWN0QWZ0ZXJOZXcgPSBnZW5lcmF0b3IgPT4ge1xyXG4gICAgbGV0IHJlZGlyZWN0VXJsXHJcbiAgICBpZiAoZ2VuZXJhdG9yKSB7XHJcbiAgICAgIGFsZXJ0T2soJ0d1YXJkYWRvIGNvbiBleGl0bycpXHJcbiAgICAgIHJlZGlyZWN0VXJsID0gYCR7Z2VuZXJhdG9yLmxpbmt9P2VkaXQ9MWBcclxuICAgIH0gZWxzZSB7XHJcbiAgICAgIGFsZXJ0T2soJ0NvbnRlbmlkbyBlbGltaW5hZG8gY29uIGV4aXRvJylcclxuICAgICAgcmVkaXJlY3RVcmwgPSBgL2dlbmVyYWRvcmVzL2BcclxuICAgIH1cclxuICAgIHNldFRpbWVvdXQoKCkgPT4ge1xyXG4gICAgICB3aW5kb3cubG9jYXRpb24uaHJlZiA9IHJlZGlyZWN0VXJsXHJcbiAgICB9LCA1MDApXHJcbiAgfVxyXG5cclxuICBjb25zdCBzYXZlQ29udGVudCA9IHNvdXJjZUlkID0+IHtcclxuICAgIGNvbnN0IGlkID0gc291cmNlSWQgPT09ICdORVcnID8gJycgOiBzb3VyY2VJZFxyXG4gICAgY29uc3QgbmFtZSA9ICR0YWJsZU5hbWUudmFsKCkudHJpbSgpXHJcbiAgICBjb25zdCBkZXNjID0gJHRhYmxlRGVzYy52YWwoKS50cmltKClcclxuICAgIGlmICghbmFtZSB8fCAhZGVzYykge1xyXG4gICAgICBzaG93RXJyb3IoJ0ZhbHRhIG5vbWJyZSBvIGRlc2NyaXBjaW9uJylcclxuICAgICAgcmV0dXJuXHJcbiAgICB9XHJcbiAgICBjb25zdCBjb250ZW50ID0ge1xyXG4gICAgICBuYW1lLCBkZXNjLFxyXG4gICAgICBkYXRhOiB7XHJcbiAgICAgICAgdHBsczogZ2V0VHBscygkdHBscy52YWwoKSksXHJcbiAgICAgICAgdGFibGVzOiAkc291cmNlcy52YWwoKVxyXG4gICAgICB9XHJcbiAgICB9XHJcblxyXG4gICAgaWYgKGlkKSB7XHJcbiAgICAgIHJldHVybiBnZW4ucmVtb3Rlcy51cGRhdGUoaWQsIGNvbnRlbnQpLnRoZW4ocmVzID0+IHtcclxuICAgICAgICBhbGVydE9rKCdHdWFyZGFkbyBjb24gZXhpdG8nKVxyXG4gICAgICB9KVxyXG4gICAgICAgIC5jYXRjaChlcnIgPT4ge1xyXG4gICAgICAgICAgc2hvd0Vycm9yKGVyci5tZXNzYWdlKVxyXG4gICAgICAgIH0pXHJcbiAgICB9XHJcblxyXG4gICAgZ2VuLnJlbW90ZXMuY3JlYXRlKGNvbnRlbnQpXHJcbiAgICAgIC50aGVuKHJlZGlyZWN0QWZ0ZXJOZXcpXHJcbiAgICAgIC5jYXRjaChlcnIgPT4ge1xyXG4gICAgICAgIHNob3dFcnJvcihlcnIubWVzc2FnZSlcclxuICAgICAgfSlcclxuICB9XHJcblxyXG4gIGNvbnN0IGZvcmtDb250ZW50ID0gc291cmNlSWQgPT4ge1xyXG4gICAgY29uc3QgbmFtZSA9IGAkeyR0YWJsZU5hbWUudmFsKCkudHJpbSgpfSAtIGNvcGlhYFxyXG4gICAgY29uc3QgZGVzYyA9ICR0YWJsZURlc2MudmFsKCkudHJpbSgpXHJcbiAgICBpZiAoIW5hbWUgfHwgIWRlc2MpIHtcclxuICAgICAgc2hvd0Vycm9yKCdGYWx0YSBub21icmUgbyBkZXNjcmlwY2lvbicpXHJcbiAgICAgIHJldHVyblxyXG4gICAgfVxyXG5cclxuICAgIGdlbi5yZW1vdGVzLmNyZWF0ZSh7XHJcbiAgICAgIG5hbWUsIGRlc2MsXHJcbiAgICAgIHBhcmVudDogc291cmNlSWQsXHJcbiAgICAgIGRhdGE6IHtcclxuICAgICAgICB0cGxzOiBnZXRUcGxzKCR0cGxzLnZhbCgpKSxcclxuICAgICAgICB0YWJsZXM6ICRzb3VyY2VzLnZhbCgpXHJcbiAgICAgIH1cclxuICAgIH0pLnRoZW4ocmVkaXJlY3RBZnRlck5ldylcclxuICAgICAgLmNhdGNoKGVyciA9PiB7XHJcbiAgICAgICAgc2hvd0Vycm9yKGVyci5tZXNzYWdlKVxyXG4gICAgICB9KVxyXG4gIH1cclxuXHJcbiAgY29uc3QgcmVtb3ZlQ29udGVudCA9IHNvdXJjZUlkID0+IHtcclxuXHJcbiAgICBjb25zdCByZW1vdmVDb25maXJtbWF0aW9uID0gY29uZmlybSgnUXVpZXJlcyBib3JyYXIgZXN0ZSBnZW5lcmFkb3I/IEVzdGEgYWNjaW9uIG5vIHNlIHB1ZWRlIGRlc2hhY2VyLicpXHJcblxyXG4gICAgaWYgKCFyZW1vdmVDb25maXJtbWF0aW9uKSB7XHJcbiAgICAgIHJldHVyblxyXG4gICAgfVxyXG4gICAgZ2VuLnJlbW90ZXMucmVtb3ZlKHNvdXJjZUlkKVxyXG4gICAgICAudGhlbigoKSA9PiByZWRpcmVjdEFmdGVyTmV3KCkpXHJcbiAgICAgIC5jYXRjaChlcnIgPT4ge1xyXG4gICAgICAgIHNob3dFcnJvcihlcnIubWVzc2FnZSlcclxuICAgICAgfSlcclxuICB9XHJcblxyXG4gIGNvbnN0IGVuYWJsZUxvZ2dlZFVJID0gZGF0YSA9PiB7XHJcbiAgICBpZiAoIWRhdGEgfHwgU09VUkNFX0lEID09PSAnTkVXJykge1xyXG4gICAgICAkKCcjc2F2ZScpLnJlbW92ZUNsYXNzKCdkaXNhYmxlZCcpLm9mZignY2xpY2snKS5vbignY2xpY2snLCAoKSA9PiBzYXZlQ29udGVudChTT1VSQ0VfSUQpKVxyXG4gICAgICByZXR1cm5cclxuICAgIH1cclxuXHJcbiAgICAkKCcjZm9yaycpLnJlbW92ZUNsYXNzKCdkaXNhYmxlZCcpLm9mZignY2xpY2snKS5vbignY2xpY2snLCAoKSA9PiBmb3JrQ29udGVudChTT1VSQ0VfSUQpKVxyXG5cclxuICAgIGlmIChkYXRhLm93bmVkKSB7XHJcbiAgICAgICQoJyNyZW1vdmUnKS5yZW1vdmVDbGFzcygnZGlzYWJsZWQnKS5vZmYoJ2NsaWNrJykub24oJ2NsaWNrJywgKCkgPT4gcmVtb3ZlQ29udGVudChTT1VSQ0VfSUQpKVxyXG5cclxuICAgIH1cclxuICB9XHJcbiAgXHJcbiAgY29uc3QgdXBkYXRlVGl0bGUgPSBlID0+IHtcclxuICAgICR0YWJsZVRpdGxlLmh0bWwoJChlLnRhcmdldCkudmFsKCkpXHJcbiAgfVxyXG5cclxuICBjb25zdCBzaG93R2VuZXJhdG9yID0gc291cmNlSWQgPT4ge1xyXG5cclxuICAgICRnZW5lcmF0b3IucmVtb3ZlQ2xhc3MoJ2hpZGUnKVxyXG5cclxuICAgICR0cGxzLm9uKCdjaGFuZ2UnLCByZXN0YXJ0R2VuZXJhdG9yKVxyXG4gICAgJHRhYmxlTmFtZS5vbignY2hhbmdlJywgdXBkYXRlVGl0bGUpXHJcbiAgICAkc291cmNlcy5vbignY2hhbmdlJywgcmVzdGFydEdlbmVyYXRvcilcclxuICAgICRidG5SZWdlbi5vbignY2xpY2snLCBydW5HZW5lcmF0b3IpXHJcblxyXG4gICAgaWYgKHNvdXJjZUlkID09PSAnTkVXJykge1xyXG4gICAgICByZXN0YXJ0R2VuZXJhdG9yKClcclxuICAgICAgcmV0dXJuXHJcbiAgICB9XHJcblxyXG4gICAgZ2VuLnJlbW90ZXMubG9hZChzb3VyY2VJZCkudGhlbihyZXMgPT4ge1xyXG4gICAgICByZXR1cm4gcmVzIHx8IFByb21pc2UucmVqZWN0KGBObyBoYXkgZGF0b3MgcGFyYSBlbCBpZGVudGlmaWNhZG9yICR7c291cmNlSWR9YClcclxuICAgIH0pXHJcbiAgICAgIC50aGVuKHJlcyA9PiB7XHJcbiAgICAgICAgJHRhYmxlTmFtZS52YWwocmVzLm5hbWUpXHJcbiAgICAgICAgJHRhYmxlRGVzYy52YWwocmVzLmRlc2MpXHJcbiAgICAgICAgJHRwbHMudmFsKGdldFRwbHMocmVzLmRhdGEudHBscykpXHJcbiAgICAgICAgJHNvdXJjZXMudmFsKHJlcy5kYXRhLnRhYmxlcylcclxuICAgICAgICBlbmFibGVMb2dnZWRVSShyZXMpXHJcbiAgICAgICAgcmVzdGFydEdlbmVyYXRvcigpXHJcbiAgICAgICAgcnVuR2VuZXJhdG9yKClcclxuICAgICAgfSlcclxuICAgICAgLmNhdGNoKGVyciA9PiB7XHJcbiAgICAgICAgc2hvd0Vycm9yKGBObyBoYXkgZGF0b3MgcGFyYSBlbCBpZGVudGlmaWNhZG9yICR7c291cmNlSWR9YClcclxuICAgICAgfSlcclxuXHJcbiAgfVxyXG5cclxuICAkKCgpID0+IHtcclxuXHJcblxyXG4gICAgU09VUkNFX0lEID0gR0VORVJBVE9SX1NPVVJDRV9JRCB8fCBnZXRSZW1vdGVGcm9tVXJsKHdpbmRvdy5sb2NhdGlvbi5ocmVmKVxyXG5cclxuICAgIGlmICghU09VUkNFX0lEKSB7XHJcbiAgICAgICRleGFtcGxlcy5yZW1vdmVDbGFzcygnaGlkZScpXHJcbiAgICAgIHJldHVyblxyXG4gICAgfVxyXG5cclxuICAgIHNob3dHZW5lcmF0b3IoU09VUkNFX0lEKVxyXG5cclxuICAgIGNvbnN0IGNsaXBib2FyZCA9IG5ldyBDbGlwYm9hcmQoJyNidG4tY29weScpO1xyXG4gICAgY2xpcGJvYXJkLm9uKCdzdWNjZXNzJywgZSA9PiB7XHJcbiAgICAgIGFsZXJ0T2soJ0NvcGlhZG8gYWwgcG9ydGFwYXBlbGVzJylcclxuICAgICAgZS5jbGVhclNlbGVjdGlvbigpO1xyXG4gICAgfSk7XHJcblxyXG5cclxuICAgIGdlbi5nZXRUb2tlbkZyb21BdXRoKClcclxuICAgICAgLnRoZW4odG9rZW4gPT4ge1xyXG4gICAgICAgIGVuYWJsZUxvZ2dlZFVJKClcclxuICAgICAgfSlcclxuICAgICAgLmNhdGNoKGVyciA9PiB7fSlcclxuICB9KVxyXG5cclxufSgpKVxyXG4iXX0=

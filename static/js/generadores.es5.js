(function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a=typeof require=="function"&&require;if(!u&&a)return a(o,!0);if(i)return i(o,!0);var f=new Error("Cannot find module '"+o+"'");throw f.code="MODULE_NOT_FOUND",f}var l=n[o]={exports:{}};t[o][0].call(l.exports,function(e){var n=t[o][1][e];return s(n?n:e)},l,l.exports,e,t,n,r)}return n[o].exports}var i=typeof require=="function"&&require;for(var o=0;o<r.length;o++)s(r[o]);return s})({1:[function(require,module,exports){
"use strict";!function(){var e=void 0,t=function(e){var t=n(e);return t&&t.params?t.params.id:""},n=function(e){var t=document.createElement("a");return t.href=e,{source:e,protocol:t.protocol.replace(":",""),host:t.hostname,port:t.port,query:t.search,params:function(){for(var e,n={},a=t.search.replace(/^\?/,"").split("&"),o=a.length,r=0;o>r;r++)a[r]&&(e=a[r].split("="),n[e[0]]=e[1]);return n}(),file:(t.pathname.match(/\/([^\/?#]+)$/i)||[,""])[1],hash:t.hash.replace("#",""),path:t.pathname.replace(/^([^\/])/,"/$1"),relative:(t.href.match(/tp:\/\/[^\/]+(.+)/)||[,""])[1],segments:t.pathname.replace(/^\//,"").split("/")}},a=function(e){return $.simplyToast(e,"danger")},o=function(e){return $.simplyToast(e,"success")},r=n(window.location.url),c=!1,i=$("#tpls"),s=$("#sources"),l=$("#btn-regen"),u=$("#runner-output"),d=$("#generator-featured, #generator-list"),p=$("#generator"),f=$("#generator-name"),h=$("#generator-desc"),m=void 0,v=new Generador({host:"//"+r.host+(r.port?":"+r.port:"")}),g=function(e){return e.match(/;@tpl\|/m)?e:";@tpl|main\n"+e},b=function(){var e=g(i.val());m=v.parseString(""+e+s.val()).then(function(){c=!0,w()})},w=function(){c&&u.empty().append(v.toHtml(v.generate()))},k=function(e){o("Guardado con exito"),console.log("RES",e),setTimeout(function(){window.location.href=e.link+"?edit=1"},500)},E=function(e){var t="NEW"===e?"":e,n=f.val().trim(),r=h.val().trim();if(!n||!r)return void a("Falta nombre o descripcion");var c={name:n,desc:r,data:{tpls:g(i.val()),tables:s.val()}};return t?v.remotes.update(t,c).then(function(e){o("Guardado con exito")})["catch"](function(e){a(e.message)}):void v.remotes.create(c).then(k)["catch"](function(e){a(e.message)})},y=function(e){var t=f.val().trim()+" - copia",n=h.val().trim();return t&&n?void v.remotes.create({name:t,desc:n,parent:e,data:{tpls:g(i.val()),tables:s.val()}}).then(k)["catch"](function(e){a(e.message)}):void a("Falta nombre o descripcion")},C=function(){$("#save").removeClass("disabled").off("click").on("click",function(){return E(e)}),"NEW"!==e&&$("#fork").removeClass("disabled").off("click").on("click",function(){return y(e)})},N=function(){$twitterShare.data("")},S=function(e){return p.removeClass("hide"),i.on("change",b),f.on("change",N),s.on("change",b),l.on("click",w),"NEW"===e?void b():void v.remotes.load(e).then(function(t){return t||Promise.reject("No hay datos para el identificador "+e)}).then(function(e){f.val(e.name),h.val(e.desc),i.val(g(e.data.tpls)),s.val(e.data.tables),b(),w()})["catch"](function(t){a("No hay datos para el identificador "+e)})};$(function(){if(e=GENERATOR_SOURCE_ID||t(window.location.href),!e)return void d.removeClass("hide");S(e);var n=new Clipboard("#btn-copy");n.on("success",function(e){o("Copiado al portapapeles"),e.clearSelection()}),v.getTokenFromAuth().then(function(e){C()})["catch"](function(e){})})}();

},{}]},{},[1])
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIkM6L1VzZXJzL2d1dS9BcHBEYXRhL1JvYW1pbmcvbnBtL25vZGVfbW9kdWxlcy9icm93c2VyaWZ5L25vZGVfbW9kdWxlcy9icm93c2VyLXBhY2svX3ByZWx1ZGUuanMiLCJEOlxcd29ya3NwYWNlXFxjb21wYXJ0aWRvXFxIRVJPS1VcXHJvbGVhbmRvXFxzdGF0aWNcXGpzXFxnZW5lcmFkb3Jlcy5qcyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFBQTtBQ0FBLGNBQ0UsV0FFQSxHQUFJLEdBQUEsT0FDRSxFQUFtQixTQUFBLEdBQ3ZCLEdBQU0sR0FBTSxFQUFTLEVBQ3JCLE9BQVEsSUFBTyxFQUFJLE9BQVUsRUFBSSxPQUFPLEdBQUssSUFHekMsRUFBVyxTQUFBLEdBQ2YsR0FBSSxHQUFJLFNBQVMsY0FBYyxJQUUvQixPQURBLEdBQUUsS0FBTyxHQUVQLE9BQVEsRUFDUixTQUFVLEVBQUUsU0FBUyxRQUFRLElBQUssSUFDbEMsS0FBTSxFQUFFLFNBQ1IsS0FBTSxFQUFFLEtBQ1IsTUFBTyxFQUFFLE9BQ1QsT0FBUyxXQUlQLElBSEEsR0FFMkIsR0FGdkIsS0FDRixFQUFNLEVBQUUsT0FBTyxRQUFRLE1BQU0sSUFBSSxNQUFNLEtBQ3ZDLEVBQU0sRUFBSSxPQUFRLEVBQUksRUFDaEIsRUFBRixFQUFNLElBQ0wsRUFBSSxLQUNULEVBQUksRUFBSSxHQUFHLE1BQU0sS0FDakIsRUFBSSxFQUFFLElBQU0sRUFBRSxHQUVoQixPQUFPLE1BRVQsTUFBTyxFQUFFLFNBQVMsTUFBTSxvQkFBcUIsQ0FBRyxLQUFLLEdBQ3JELEtBQU0sRUFBRSxLQUFLLFFBQVEsSUFBSyxJQUMxQixLQUFNLEVBQUUsU0FBUyxRQUFRLFdBQVksT0FDckMsVUFBVyxFQUFFLEtBQUssTUFBTSx1QkFBd0IsQ0FBRyxLQUFLLEdBQ3hELFNBQVUsRUFBRSxTQUFTLFFBQVEsTUFBTyxJQUFJLE1BQU0sT0FJNUMsRUFBWSxTQUFBLEdBQUEsTUFBTyxHQUFFLFlBQVksRUFBSyxXQUN0QyxFQUFVLFNBQUEsR0FBQSxNQUFPLEdBQUUsWUFBWSxFQUFLLFlBRXBDLEVBQU8sRUFBUyxPQUFPLFNBQVMsS0FFbEMsR0FBVSxFQUNSLEVBQVEsRUFBRSxTQUNWLEVBQVcsRUFBRSxZQUNiLEVBQVksRUFBRSxjQUNkLEVBQVUsRUFBRSxrQkFDWixFQUFZLEVBQUUsd0NBQ2QsRUFBYSxFQUFFLGNBQ2YsRUFBYSxFQUFFLG1CQUNmLEVBQWEsRUFBRSxtQkFFakIsRUFBQSxPQUVFLEVBQU0sR0FBSSxZQUNkLEtBQUEsS0FBVyxFQUFLLE1BQU8sRUFBSyxLQUFPLElBQUssRUFBSyxLQUFPLE1BR2hELEVBQVUsU0FBQSxHQUNkLE1BQUssR0FBSSxNQUFNLFlBR1IsRUFGTCxlQUFzQixHQUtwQixFQUFtQixXQUN2QixHQUFNLEdBQU8sRUFBUSxFQUFNLE1BQzNCLEdBQVksRUFBSSxZQUFKLEdBQW1CLEVBQU8sRUFBUyxPQUFTLEtBQUssV0FDM0QsR0FBVSxFQUNWLE9BR0UsRUFBZSxXQUNkLEdBRUwsRUFBUSxRQUFRLE9BQU8sRUFBSSxPQUFPLEVBQUksY0FHbEMsRUFBbUIsU0FBQSxHQUN2QixFQUFRLHNCQUNSLFFBQVEsSUFBSSxNQUFPLEdBQ25CLFdBQVcsV0FDVCxPQUFPLFNBQVMsS0FBVSxFQUFVLEtBQXBDLFdBQ0MsTUFHQyxFQUFjLFNBQUEsR0FDbEIsR0FBTSxHQUFrQixRQUFiLEVBQXFCLEdBQUssRUFDL0IsRUFBTyxFQUFXLE1BQU0sT0FDeEIsRUFBTyxFQUFXLE1BQU0sTUFDOUIsS0FBSyxJQUFTLEVBRVosV0FEQSxHQUFVLDZCQUdaLElBQU0sSUFDSixLQUFBLEVBQU0sS0FBQSxFQUNOLE1BQ0UsS0FBTSxFQUFRLEVBQU0sT0FDcEIsT0FBUSxFQUFTLE9BSXJCLE9BQUksR0FDSyxFQUFJLFFBQVEsT0FBTyxFQUFJLEdBQVMsS0FBSyxTQUFBLEdBQzFDLEVBQVEsd0JBREgsU0FHRSxTQUFBLEdBQ0wsRUFBVSxFQUFJLGVBSXBCLEdBQUksUUFBUSxPQUFPLEdBQ2hCLEtBQUssR0FEUixTQUVTLFNBQUEsR0FDTCxFQUFVLEVBQUksWUFJZCxFQUFjLFNBQUEsR0FDbEIsR0FBTSxHQUFVLEVBQVcsTUFBTSxPQUEzQixXQUNBLEVBQU8sRUFBVyxNQUFNLE1BQzlCLE9BQUssSUFBUyxNQUtkLEdBQUksUUFBUSxRQUNWLEtBQUEsRUFBTSxLQUFBLEVBQ04sT0FBUSxFQUNSLE1BQ0UsS0FBTSxFQUFRLEVBQU0sT0FDcEIsT0FBUSxFQUFTLFNBRWxCLEtBQUssR0FQUixTQVFTLFNBQUEsR0FDTCxFQUFVLEVBQUksZUFiaEIsR0FBVSwrQkFpQlIsRUFBaUIsV0FDckIsRUFBRSxTQUFTLFlBQVksWUFBWSxJQUFJLFNBQVMsR0FBRyxRQUFTLFdBQUEsTUFBTSxHQUFZLEtBRTVELFFBQWQsR0FFSixFQUFFLFNBQVMsWUFBWSxZQUFZLElBQUksU0FBUyxHQUFHLFFBQVMsV0FBQSxNQUFNLEdBQVksTUFHMUUsRUFBa0IsV0FDdEIsY0FBYyxLQUFLLEtBR2YsRUFBZ0IsU0FBQSxHQVNwQixNQVBBLEdBQVcsWUFBWSxRQUV2QixFQUFNLEdBQUcsU0FBVSxHQUNuQixFQUFXLEdBQUcsU0FBVSxHQUN4QixFQUFTLEdBQUcsU0FBVSxHQUN0QixFQUFVLEdBQUcsUUFBUyxHQUVMLFFBQWIsTUFDRixTQUlGLEdBQUksUUFBUSxLQUFLLEdBQVUsS0FBSyxTQUFBLEdBQzlCLE1BQU8sSUFBTyxRQUFRLE9BQVIsc0NBQXFELEtBRWxFLEtBQUssU0FBQSxHQUNKLEVBQVcsSUFBSSxFQUFJLE1BQ25CLEVBQVcsSUFBSSxFQUFJLE1BQ25CLEVBQU0sSUFBSSxFQUFRLEVBQUksS0FBSyxPQUMzQixFQUFTLElBQUksRUFBSSxLQUFLLFFBQ3RCLElBQ0EsTUFUSixTQVdTLFNBQUEsR0FDTCxFQUFBLHNDQUFnRCxLQUt0RCxHQUFFLFdBS0EsR0FGQSxFQUFZLHFCQUF1QixFQUFpQixPQUFPLFNBQVMsT0FFL0QsRUFFSCxXQURBLEdBQVUsWUFBWSxPQUl4QixHQUFjLEVBRWQsSUFBTSxHQUFZLEdBQUksV0FBVSxZQUNoQyxHQUFVLEdBQUcsVUFBVyxTQUFBLEdBQ3RCLEVBQVEsMkJBQ1IsRUFBRSxtQkFJSixFQUFJLG1CQUNELEtBQUssU0FBQSxHQUNKLE1BRkosU0FJUyxTQUFBIiwiZmlsZSI6ImdlbmVyYXRlZC5qcyIsInNvdXJjZVJvb3QiOiIiLCJzb3VyY2VzQ29udGVudCI6WyIoZnVuY3Rpb24gZSh0LG4scil7ZnVuY3Rpb24gcyhvLHUpe2lmKCFuW29dKXtpZighdFtvXSl7dmFyIGE9dHlwZW9mIHJlcXVpcmU9PVwiZnVuY3Rpb25cIiYmcmVxdWlyZTtpZighdSYmYSlyZXR1cm4gYShvLCEwKTtpZihpKXJldHVybiBpKG8sITApO3ZhciBmPW5ldyBFcnJvcihcIkNhbm5vdCBmaW5kIG1vZHVsZSAnXCIrbytcIidcIik7dGhyb3cgZi5jb2RlPVwiTU9EVUxFX05PVF9GT1VORFwiLGZ9dmFyIGw9bltvXT17ZXhwb3J0czp7fX07dFtvXVswXS5jYWxsKGwuZXhwb3J0cyxmdW5jdGlvbihlKXt2YXIgbj10W29dWzFdW2VdO3JldHVybiBzKG4/bjplKX0sbCxsLmV4cG9ydHMsZSx0LG4scil9cmV0dXJuIG5bb10uZXhwb3J0c312YXIgaT10eXBlb2YgcmVxdWlyZT09XCJmdW5jdGlvblwiJiZyZXF1aXJlO2Zvcih2YXIgbz0wO288ci5sZW5ndGg7bysrKXMocltvXSk7cmV0dXJuIHN9KSIsIid1c2Ugc3RyaWN0J1xyXG47KGZ1bmN0aW9uICgpIHtcclxuXHJcbiAgbGV0IFNPVVJDRV9JRFxyXG4gIGNvbnN0IGdldFJlbW90ZUZyb21VcmwgPSByYXdVcmwgPT4ge1xyXG4gICAgY29uc3QgdXJsID0gcGFyc2VVUkwocmF3VXJsKVxyXG4gICAgcmV0dXJuICh1cmwgJiYgdXJsLnBhcmFtcykgPyB1cmwucGFyYW1zLmlkIDogJydcclxuICB9XHJcblxyXG4gIGNvbnN0IHBhcnNlVVJMID0gdXJsID0+IHtcclxuICAgIHZhciBhID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnYScpXHJcbiAgICBhLmhyZWYgPSB1cmxcclxuICAgIHJldHVybiB7XHJcbiAgICAgIHNvdXJjZTogdXJsLFxyXG4gICAgICBwcm90b2NvbDogYS5wcm90b2NvbC5yZXBsYWNlKCc6JywgJycpLFxyXG4gICAgICBob3N0OiBhLmhvc3RuYW1lLFxyXG4gICAgICBwb3J0OiBhLnBvcnQsXHJcbiAgICAgIHF1ZXJ5OiBhLnNlYXJjaCxcclxuICAgICAgcGFyYW1zOiAoZnVuY3Rpb24gKCkge1xyXG4gICAgICAgIHZhciByZXQgPSB7fSxcclxuICAgICAgICAgIHNlZyA9IGEuc2VhcmNoLnJlcGxhY2UoL15cXD8vLCcnKS5zcGxpdCgnJicpLFxyXG4gICAgICAgICAgbGVuID0gc2VnLmxlbmd0aCwgaSA9IDAsIHM7XHJcbiAgICAgICAgZm9yICg7aTxsZW47aSsrKSB7XHJcbiAgICAgICAgICBpZiAoIXNlZ1tpXSkgeyBjb250aW51ZTsgfVxyXG4gICAgICAgICAgcyA9IHNlZ1tpXS5zcGxpdCgnPScpO1xyXG4gICAgICAgICAgcmV0W3NbMF1dID0gc1sxXTtcclxuICAgICAgICB9XHJcbiAgICAgICAgcmV0dXJuIHJldFxyXG4gICAgICB9KSgpLFxyXG4gICAgICBmaWxlOiAoYS5wYXRobmFtZS5tYXRjaCgvXFwvKFteXFwvPyNdKykkL2kpIHx8IFssICcnXSlbMV0sXHJcbiAgICAgIGhhc2g6IGEuaGFzaC5yZXBsYWNlKCcjJywgJycpLFxyXG4gICAgICBwYXRoOiBhLnBhdGhuYW1lLnJlcGxhY2UoL14oW15cXC9dKS8sICcvJDEnKSxcclxuICAgICAgcmVsYXRpdmU6IChhLmhyZWYubWF0Y2goL3RwOlxcL1xcL1teXFwvXSsoLispLykgfHwgWywgJyddKVsxXSxcclxuICAgICAgc2VnbWVudHM6IGEucGF0aG5hbWUucmVwbGFjZSgvXlxcLy8sICcnKS5zcGxpdCgnLycpXHJcbiAgICB9XHJcbiAgfVxyXG5cclxuICBjb25zdCBzaG93RXJyb3IgPSBlcnIgPT4gJC5zaW1wbHlUb2FzdChlcnIsICdkYW5nZXInKVxyXG4gIGNvbnN0IGFsZXJ0T2sgPSBtc2cgPT4gJC5zaW1wbHlUb2FzdChtc2csICdzdWNjZXNzJylcclxuXHJcbiAgY29uc3QgYmFzZSA9IHBhcnNlVVJMKHdpbmRvdy5sb2NhdGlvbi51cmwpXHJcblxyXG4gIGxldCBTVEFSVEVEID0gZmFsc2VcclxuICBjb25zdCAkdHBscyA9ICQoJyN0cGxzJylcclxuICBjb25zdCAkc291cmNlcyA9ICQoJyNzb3VyY2VzJylcclxuICBjb25zdCAkYnRuUmVnZW4gPSAkKCcjYnRuLXJlZ2VuJylcclxuICBjb25zdCAkb3V0cHV0ID0gJCgnI3J1bm5lci1vdXRwdXQnKVxyXG4gIGNvbnN0ICRleGFtcGxlcyA9ICQoJyNnZW5lcmF0b3ItZmVhdHVyZWQsICNnZW5lcmF0b3ItbGlzdCcpXHJcbiAgY29uc3QgJGdlbmVyYXRvciA9ICQoJyNnZW5lcmF0b3InKVxyXG4gIGNvbnN0ICR0YWJsZU5hbWUgPSAkKCcjZ2VuZXJhdG9yLW5hbWUnKVxyXG4gIGNvbnN0ICR0YWJsZURlc2MgPSAkKCcjZ2VuZXJhdG9yLWRlc2MnKVxyXG5cclxuICBsZXQgZ2VuZXJhZG9yXHJcblxyXG4gIGNvbnN0IGdlbiA9IG5ldyBHZW5lcmFkb3Ioe1xyXG4gICAgaG9zdDogYC8vJHtiYXNlLmhvc3R9JHtiYXNlLnBvcnQgPyAnOicrIGJhc2UucG9ydCA6ICcnfWBcclxuICB9KVxyXG5cclxuICBjb25zdCBnZXRUcGxzID0gc3JjID0+IHtcclxuICAgIGlmICghc3JjLm1hdGNoKC87QHRwbFxcfC9tKSkge1xyXG4gICAgICByZXR1cm4gYDtAdHBsfG1haW5cXG4ke3NyY31gXHJcbiAgICB9XHJcbiAgICByZXR1cm4gc3JjXHJcbiAgfVxyXG5cclxuICBjb25zdCByZXN0YXJ0R2VuZXJhdG9yID0gKCkgPT4ge1xyXG4gICAgY29uc3QgdHBscyA9IGdldFRwbHMoJHRwbHMudmFsKCkpXHJcbiAgICBnZW5lcmFkb3IgPSBnZW4ucGFyc2VTdHJpbmcoYCR7dHBsc30keyRzb3VyY2VzLnZhbCgpfWApLnRoZW4oKCkgPT4ge1xyXG4gICAgICBTVEFSVEVEID0gdHJ1ZVxyXG4gICAgICBydW5HZW5lcmF0b3IoKVxyXG4gICAgfSlcclxuICB9XHJcbiAgY29uc3QgcnVuR2VuZXJhdG9yID0gKCkgPT4ge1xyXG4gICAgaWYgKCFTVEFSVEVEKSByZXR1cm47XHJcblxyXG4gICAgJG91dHB1dC5lbXB0eSgpLmFwcGVuZChnZW4udG9IdG1sKGdlbi5nZW5lcmF0ZSgpKSlcclxuICB9XHJcblxyXG4gIGNvbnN0IHJlZGlyZWN0QWZ0ZXJOZXcgPSBnZW5lcmF0b3IgPT4ge1xyXG4gICAgYWxlcnRPaygnR3VhcmRhZG8gY29uIGV4aXRvJylcclxuICAgIGNvbnNvbGUubG9nKCdSRVMnLCBnZW5lcmF0b3IpXHJcbiAgICBzZXRUaW1lb3V0KCgpID0+IHtcclxuICAgICAgd2luZG93LmxvY2F0aW9uLmhyZWYgPSBgJHtnZW5lcmF0b3IubGlua30/ZWRpdD0xYFxyXG4gICAgfSwgNTAwKVxyXG4gIH1cclxuXHJcbiAgY29uc3Qgc2F2ZUNvbnRlbnQgPSBzb3VyY2VJZCA9PiB7XHJcbiAgICBjb25zdCBpZCA9IHNvdXJjZUlkID09PSAnTkVXJyA/ICcnIDogc291cmNlSWRcclxuICAgIGNvbnN0IG5hbWUgPSAkdGFibGVOYW1lLnZhbCgpLnRyaW0oKVxyXG4gICAgY29uc3QgZGVzYyA9ICR0YWJsZURlc2MudmFsKCkudHJpbSgpXHJcbiAgICBpZiAoIW5hbWUgfHwgIWRlc2MpIHtcclxuICAgICAgc2hvd0Vycm9yKCdGYWx0YSBub21icmUgbyBkZXNjcmlwY2lvbicpXHJcbiAgICAgIHJldHVyblxyXG4gICAgfVxyXG4gICAgY29uc3QgY29udGVudCA9IHtcclxuICAgICAgbmFtZSwgZGVzYyxcclxuICAgICAgZGF0YToge1xyXG4gICAgICAgIHRwbHM6IGdldFRwbHMoJHRwbHMudmFsKCkpLFxyXG4gICAgICAgIHRhYmxlczogJHNvdXJjZXMudmFsKClcclxuICAgICAgfVxyXG4gICAgfVxyXG5cclxuICAgIGlmIChpZCkge1xyXG4gICAgICByZXR1cm4gZ2VuLnJlbW90ZXMudXBkYXRlKGlkLCBjb250ZW50KS50aGVuKHJlcyA9PiB7XHJcbiAgICAgICAgYWxlcnRPaygnR3VhcmRhZG8gY29uIGV4aXRvJylcclxuICAgICAgfSlcclxuICAgICAgICAuY2F0Y2goZXJyID0+IHtcclxuICAgICAgICAgIHNob3dFcnJvcihlcnIubWVzc2FnZSlcclxuICAgICAgICB9KVxyXG4gICAgfVxyXG5cclxuICAgIGdlbi5yZW1vdGVzLmNyZWF0ZShjb250ZW50KVxyXG4gICAgICAudGhlbihyZWRpcmVjdEFmdGVyTmV3KVxyXG4gICAgICAuY2F0Y2goZXJyID0+IHtcclxuICAgICAgICBzaG93RXJyb3IoZXJyLm1lc3NhZ2UpXHJcbiAgICAgIH0pXHJcbiAgfVxyXG5cclxuICBjb25zdCBmb3JrQ29udGVudCA9IHNvdXJjZUlkID0+IHtcclxuICAgIGNvbnN0IG5hbWUgPSBgJHskdGFibGVOYW1lLnZhbCgpLnRyaW0oKX0gLSBjb3BpYWBcclxuICAgIGNvbnN0IGRlc2MgPSAkdGFibGVEZXNjLnZhbCgpLnRyaW0oKVxyXG4gICAgaWYgKCFuYW1lIHx8ICFkZXNjKSB7XHJcbiAgICAgIHNob3dFcnJvcignRmFsdGEgbm9tYnJlIG8gZGVzY3JpcGNpb24nKVxyXG4gICAgICByZXR1cm5cclxuICAgIH1cclxuXHJcbiAgICBnZW4ucmVtb3Rlcy5jcmVhdGUoe1xyXG4gICAgICBuYW1lLCBkZXNjLFxyXG4gICAgICBwYXJlbnQ6IHNvdXJjZUlkLFxyXG4gICAgICBkYXRhOiB7XHJcbiAgICAgICAgdHBsczogZ2V0VHBscygkdHBscy52YWwoKSksXHJcbiAgICAgICAgdGFibGVzOiAkc291cmNlcy52YWwoKVxyXG4gICAgICB9XHJcbiAgICB9KS50aGVuKHJlZGlyZWN0QWZ0ZXJOZXcpXHJcbiAgICAgIC5jYXRjaChlcnIgPT4ge1xyXG4gICAgICAgIHNob3dFcnJvcihlcnIubWVzc2FnZSlcclxuICAgICAgfSlcclxuICB9XHJcblxyXG4gIGNvbnN0IGVuYWJsZUxvZ2dlZFVJID0gKCkgPT4ge1xyXG4gICAgJCgnI3NhdmUnKS5yZW1vdmVDbGFzcygnZGlzYWJsZWQnKS5vZmYoJ2NsaWNrJykub24oJ2NsaWNrJywgKCkgPT4gc2F2ZUNvbnRlbnQoU09VUkNFX0lEKSlcclxuXHJcbiAgICBpZiAoU09VUkNFX0lEID09PSAnTkVXJykgcmV0dXJuXHJcblxyXG4gICAgJCgnI2ZvcmsnKS5yZW1vdmVDbGFzcygnZGlzYWJsZWQnKS5vZmYoJ2NsaWNrJykub24oJ2NsaWNrJywgKCkgPT4gZm9ya0NvbnRlbnQoU09VUkNFX0lEKSlcclxuICB9XHJcbiAgXHJcbiAgY29uc3QgdXBkYXRlU2hhcmVJbmZvID0gKCkgPT4ge1xyXG4gICAgJHR3aXR0ZXJTaGFyZS5kYXRhKCcnKVxyXG4gIH1cclxuXHJcbiAgY29uc3Qgc2hvd0dlbmVyYXRvciA9IHNvdXJjZUlkID0+IHtcclxuXHJcbiAgICAkZ2VuZXJhdG9yLnJlbW92ZUNsYXNzKCdoaWRlJylcclxuXHJcbiAgICAkdHBscy5vbignY2hhbmdlJywgcmVzdGFydEdlbmVyYXRvcilcclxuICAgICR0YWJsZU5hbWUub24oJ2NoYW5nZScsIHVwZGF0ZVNoYXJlSW5mbylcclxuICAgICRzb3VyY2VzLm9uKCdjaGFuZ2UnLCByZXN0YXJ0R2VuZXJhdG9yKVxyXG4gICAgJGJ0blJlZ2VuLm9uKCdjbGljaycsIHJ1bkdlbmVyYXRvcilcclxuXHJcbiAgICBpZiAoc291cmNlSWQgPT09ICdORVcnKSB7XHJcbiAgICAgIHJlc3RhcnRHZW5lcmF0b3IoKVxyXG4gICAgICByZXR1cm5cclxuICAgIH1cclxuXHJcbiAgICBnZW4ucmVtb3Rlcy5sb2FkKHNvdXJjZUlkKS50aGVuKHJlcyA9PiB7XHJcbiAgICAgIHJldHVybiByZXMgfHwgUHJvbWlzZS5yZWplY3QoYE5vIGhheSBkYXRvcyBwYXJhIGVsIGlkZW50aWZpY2Fkb3IgJHtzb3VyY2VJZH1gKVxyXG4gICAgfSlcclxuICAgICAgLnRoZW4ocmVzID0+IHtcclxuICAgICAgICAkdGFibGVOYW1lLnZhbChyZXMubmFtZSlcclxuICAgICAgICAkdGFibGVEZXNjLnZhbChyZXMuZGVzYylcclxuICAgICAgICAkdHBscy52YWwoZ2V0VHBscyhyZXMuZGF0YS50cGxzKSlcclxuICAgICAgICAkc291cmNlcy52YWwocmVzLmRhdGEudGFibGVzKVxyXG4gICAgICAgIHJlc3RhcnRHZW5lcmF0b3IoKVxyXG4gICAgICAgIHJ1bkdlbmVyYXRvcigpXHJcbiAgICAgIH0pXHJcbiAgICAgIC5jYXRjaChlcnIgPT4ge1xyXG4gICAgICAgIHNob3dFcnJvcihgTm8gaGF5IGRhdG9zIHBhcmEgZWwgaWRlbnRpZmljYWRvciAke3NvdXJjZUlkfWApXHJcbiAgICAgIH0pXHJcblxyXG4gIH1cclxuXHJcbiAgJCgoKSA9PiB7XHJcblxyXG5cclxuICAgIFNPVVJDRV9JRCA9IEdFTkVSQVRPUl9TT1VSQ0VfSUQgfHwgZ2V0UmVtb3RlRnJvbVVybCh3aW5kb3cubG9jYXRpb24uaHJlZilcclxuXHJcbiAgICBpZiAoIVNPVVJDRV9JRCkge1xyXG4gICAgICAkZXhhbXBsZXMucmVtb3ZlQ2xhc3MoJ2hpZGUnKVxyXG4gICAgICByZXR1cm5cclxuICAgIH1cclxuXHJcbiAgICBzaG93R2VuZXJhdG9yKFNPVVJDRV9JRClcclxuXHJcbiAgICBjb25zdCBjbGlwYm9hcmQgPSBuZXcgQ2xpcGJvYXJkKCcjYnRuLWNvcHknKTtcclxuICAgIGNsaXBib2FyZC5vbignc3VjY2VzcycsIGUgPT4ge1xyXG4gICAgICBhbGVydE9rKCdDb3BpYWRvIGFsIHBvcnRhcGFwZWxlcycpXHJcbiAgICAgIGUuY2xlYXJTZWxlY3Rpb24oKTtcclxuICAgIH0pO1xyXG5cclxuXHJcbiAgICBnZW4uZ2V0VG9rZW5Gcm9tQXV0aCgpXHJcbiAgICAgIC50aGVuKHRva2VuID0+IHtcclxuICAgICAgICBlbmFibGVMb2dnZWRVSSgpXHJcbiAgICAgIH0pXHJcbiAgICAgIC5jYXRjaChlcnIgPT4ge30pXHJcbiAgfSlcclxuXHJcbn0oKSlcclxuIl19
